# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö MongoDB - North Republic

## –û–±–∑–æ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** `northrepublic`  
**–ü–æ—Ä—Ç:** `27018` (–Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)  
**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** `mongodb://localhost:27018`

---

## üìä –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

### 1. **admin_users** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∞–¥–º–∏–Ω–∫–∏
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Å–∞–π—Ç–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": ObjectId,
  "username": "zapleosoft",
  "password_hash": "$2y$10$...",
  "email": "admin@northrepublic.me",
  "role": "admin",
  "status": "active",
  "created_at": ISODate,
  "last_login": ISODate,
  "login_attempts": 0,
  "locked_until": null,
  "permissions": ["pages", "users", "logs", "database", "sepay"]
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω–∫–µ (`/admin/auth/login.php`)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (`/admin/users/`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (`admin/includes/auth-check.php`)

---

### 2. **admin_logs** - –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—É–¥–∏—Ç –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": ObjectId,
  "action": "login",
  "message": "–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É",
  "data": {
    "username": "zapleosoft",
    "ip": "192.168.1.1"
  },
  "metadata": {
    "user_agent": "Mozilla/5.0...",
    "session_id": "abc123"
  },
  "timestamp": ISODate,
  "level": "info"
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ (`/admin/logs/`)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞—É–¥–∏—Ç
- –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

---

### 3. **page_content** - –ö–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü —Å–∞–π—Ç–∞
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": ObjectId,
  "page": "home",
  "language": "ru",
  "content": "<div>–ü–æ–ª–Ω—ã–π HTML –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã...</div>",
  "meta": {
    "title": "North Republic - –ì–ª–∞–≤–Ω–∞—è",
    "description": "–†–µ—Å—Ç–æ—Ä–∞–Ω –≤ –ù—è—á–∞–Ω–≥–µ",
    "keywords": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω, –Ω—è—á–∞–Ω–≥, –≤—å–µ—Ç–Ω–∞–º"
  },
  "status": "published",
  "updated_at": ISODate,
  "updated_by": "admin"
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ —Å–∞–π—Ç–µ (`index.php`)
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ (`/admin/pages/`)
- –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å (ru, en, vi)

---

### 4. **admin_texts** - –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (—É—Å—Ç–∞—Ä–µ–≤—à–∞—è —Å–∏—Å—Ç–µ–º–∞)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": ObjectId,
  "key": "menu.home",
  "ru": "–ì–ª–∞–≤–Ω–∞—è",
  "en": "Home",
  "vi": "Trang ch·ªß",
  "category": "navigation",
  "updated_at": ISODate
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ü–µ—Ä–µ–≤–æ–¥—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `page_content`)
- –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

---

### 5. **menu** - –ö—ç—à –º–µ–Ω—é —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω—é –∏–∑ Poster API

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": "current_menu",
  "data": {
    "categories": [...],
    "products": [...]
  },
  "categories": [
    {
      "category_id": "123",
      "category_name": "–û—Å–Ω–æ–≤–Ω—ã–µ –±–ª—é–¥–∞",
      "category_hidden": "0",
      "visible": [{"spot": "1", "visible": "1"}]
    }
  ],
  "products": [
    {
      "product_id": "456",
      "product_name": "–§–æ –ë–æ",
      "menu_category_id": "123",
      "price": {"1": 150000},
      "hidden": "0",
      "spots": [{"spot": "1", "visible": "1"}],
      "sort_order": 10
    }
  ],
  "updated_at": ISODate
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–Ω—é –Ω–∞ —Å–∞–π—Ç–µ (`index.php`)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö Poster API
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏

---

### 6. **sepay_logs** - –õ–æ–≥–∏ –ø–ª–∞—Ç–µ–∂–µ–π Sepay
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π BIDV

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": ObjectId,
  "transaction_id": "TXN123456789",
  "amount": 500000,
  "status": "success",
  "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #12345",
  "account_number": "1234567890",
  "bank_code": "BIDV",
  "timestamp": ISODate,
  "raw_data": {...},
  "processed_at": ISODate
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–ª–∞—Ç–µ–∂–µ–π (`/admin/sepay/`)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º

---

### 7. **rate_limits** - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": ObjectId,
  "identifier": "192.168.1.1",
  "timestamp": ISODate,
  "ip": "192.168.1.1",
  "user_agent": "Mozilla/5.0...",
  "endpoint": "/api/menu"
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- Rate limiting API –∑–∞–ø—Ä–æ—Å–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

---

### 8. **admin_sessions** - –°–µ—Å—Å–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "_id": ObjectId,
  "session_id": "abc123def456",
  "user_id": ObjectId,
  "username": "zapleosoft",
  "ip_address": "192.168.1.1",
  "user_agent": "Mozilla/5.0...",
  "created_at": ISODate,
  "expires_at": ISODate,
  "last_activity": ISODate,
  "is_active": true
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥

---

## üîó –°–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–≤—è–∑–∏:
1. **admin_users** ‚Üî **admin_logs** (–ø–æ username)
2. **page_content** ‚Üî **admin_texts** (–ø–æ –∫–ª—é—á–∞–º –ø–µ—Ä–µ–≤–æ–¥–æ–≤)
3. **menu** ‚Üí **Poster API** (–≤–Ω–µ—à–Ω—è—è —Å–∏—Å—Ç–µ–º–∞)
4. **sepay_logs** ‚Üí **BIDV API** (–≤–Ω–µ—à–Ω—è—è —Å–∏—Å—Ç–µ–º–∞)

### –ò–Ω–¥–µ–∫—Å—ã:
```javascript
// admin_users
db.admin_users.createIndex({"username": 1}, {"unique": true})
db.admin_users.createIndex({"email": 1}, {"unique": true})

// admin_logs
db.admin_logs.createIndex({"timestamp": -1})
db.admin_logs.createIndex({"action": 1})

// page_content
db.page_content.createIndex({"page": 1, "language": 1}, {"unique": true})
db.page_content.createIndex({"status": 1})

// sepay_logs
db.sepay_logs.createIndex({"timestamp": -1})
db.sepay_logs.createIndex({"transaction_id": 1}, {"unique": true})
db.sepay_logs.createIndex({"status": 1})

// rate_limits
db.rate_limits.createIndex({"identifier": 1, "timestamp": 1})
db.rate_limits.createIndex({"timestamp": 1}, {"expireAfterSeconds": 900})
```

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º:
- **admin_users**: ~5-10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **admin_logs**: ~1000+ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Ä–∞—Å—Ç–µ—Ç)
- **page_content**: ~50-100 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **admin_texts**: ~200-500 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **menu**: 1 –¥–æ–∫—É–º–µ–Ω—Ç (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
- **sepay_logs**: ~100-1000 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **rate_limits**: ~100-1000 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞)

### –†–∞–∑–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö:
- **admin_users**: ~1KB
- **admin_logs**: ~1-10MB
- **page_content**: ~100KB-1MB
- **menu**: ~50-200KB
- **sepay_logs**: ~1-5MB

---

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

### –ê–¥–º–∏–Ω–∫–∞:
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: `/admin/users/`
- **–°—Ç—Ä–∞–Ω–∏—Ü—ã**: `/admin/pages/`
- **–õ–æ–≥–∏**: `/admin/logs/`
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: `/admin/database/`
- **–ü–ª–∞—Ç–µ–∂–∏**: `/admin/sepay/`

### API:
- **–ú–µ–Ω—é**: `/api/menu/` (Node.js)
- **Poster**: `/api/poster/` (Node.js)
- **–ö—ç—à**: `/api/cache/` (Node.js)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –º–µ–Ω—é (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
- –û—á–∏—Å—Ç–∫–∞ rate_limits (–∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç)
- –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (–ø–æ —Ä–∞–∑–º–µ—Ä—É/–≤—Ä–µ–º–µ–Ω–∏)

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –î–æ—Å—Ç—É–ø:
- MongoDB –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ admin_users
- Rate limiting –¥–ª—è API
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±—ç–∫–∞–ø—ã MongoDB
- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ú–∏–≥—Ä–∞—Ü–∏—è**: –ü—Ä–æ–µ–∫—Ç –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å JSON —Ñ–∞–π–ª–æ–≤ –Ω–∞ MongoDB
2. **Fallback**: –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é)
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û—Ç–∫–ª—é—á–µ–Ω–æ –≤ –ø–æ–ª—å–∑—É Cloudflare
4. **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ru, en, vi
5. **API**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Poster API –∏ BIDV Sepay
